self.onmessage=async n=>{const t=n.data;if(t.kind==="export")try{console.log("Loading FFmpeg module dynamically...");const{createFFmpeg:e,fetchFile:g}=await import("./index-CDXKtiT_.js"),o=e({log:!0,progress:({ratio:p})=>{self.postMessage({kind:"progress",value:p})}});o.isLoaded()||(console.log("Initializing FFmpeg core..."),await o.load(),console.log("âœ… FFmpeg ready")),console.log("Fetching input source...");const a=await fetch(t.src),r=new Uint8Array(await a.arrayBuffer());o.FS("writeFile","input.mp4",r);const s=["-i","input.mp4","-c:v","libx264","-preset","ultrafast","-vf",`scale=${t.width}:${t.height}:flags=lanczos`,"-pix_fmt","yuv420p","-y","output.mp4"];console.log("ğŸš€ Running FFmpeg:",s.join(" ")),await o.run(...s);const i=o.FS("readFile","output.mp4"),l=new Blob([i.buffer],{type:"video/mp4"}),c=URL.createObjectURL(l);self.postMessage({kind:"done",url:c}),console.log("ğŸ‰ Export complete!")}catch(e){console.error("âŒ FFmpeg export failed:",e),self.postMessage({kind:"error",message:(e==null?void 0:e.message)??"Unknown export error"})}};
